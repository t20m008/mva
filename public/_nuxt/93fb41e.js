(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{904:function(t,e,n){"use strict";n.r(e);var r=n(10),o=(n(7),n(11),n(190),n(78),n(55),n(858)),c={components:{VueJsonToCsv:n.n(o).a},data:function(){return{logUsers:[],selected:null,selectedBoolean:!0,history:[],sCSV:"",jsonData:[],csvTitle:"",csvData:[],labels:{date:{title:"date"},timestamp:{title:"timestamp"},id:{title:"id"},action:{title:"action"},href:{title:"href"},tex:{title:"tex"}}}},watch:{selected:function(t,e){null!=t&&(this.selectedBoolean=!1,this.getHistory(t)),e!==t&&(this.history=[])}},mounted:function(){var t=this;function e(){return(e=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadLogUsers();case 2:t.logUsers=e.sent;case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},methods:{loadMessage:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$store.state.chat.chatId,r=[],e.next=4,t.chatCollection.doc(n).collection("messages").orderBy("timestamp").onSnapshot((function(t){t.docChanges().forEach((function(t,e){if("removed"!==t.type){var n=t.doc.data();n.id=t.doc.id,r.push(n)}else r.splice(t.oldIndex,1)}))}));case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))()},deleteMessage:function(t){this.$fire.firestore.collection("chat").doc(this.chatId).collection("messages").doc(t).delete().then((function(){})).catch((function(t){console.log(t)}))},download:function(){var t=this;this.csvTitle="nxlg_"+Date.now(),this.history.forEach((function(data){t.csvData.push({date:data.date,timestamp:data.timestamp,id:data.id,action:data.action,href:data.href,tex:data.tex})}))},getUniqueStr:function(t){var strong=1e3;return t&&(strong=t),(new Date).getTime().toString(16)+Math.floor(strong*Math.random()).toString(16)},loadLogUsers:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,t.$fire.firestore.collection("log").get().then((function(t){t.forEach((function(t){n.push({text:t.data().displayName,value:t.data().uid})}))}));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))()},getHistory:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.next=3,e.$fire.firestore.collection("log").doc(t).collection("history").get().then((function(t){t.forEach((function(t){r.push({text:t.data().displayName,value:t.data().uid}),e.history.push(t.data())}))})).catch((function(t){console.log(t)}));case 3:return n.abrupt("return",r);case 4:case"end":return n.stop()}}),n)})))()},createCSV:function(t){var e=this;this.sCSV="date,timestamp,id,action,tex,href\n";var n=[];t.forEach((function(data,i){n.push(data)})),this.jsonData=n,t.forEach((function(t,i){console.table([t.date,t.timestamp,t.id,t.action,t.tex,t.href]),e.sCSV+=t.date+","+t.timestamp+","+t.id+","+t.action+',"'+t.tex+'",'+t.href+"\n"}))},createJSON:function(t){var e=[];t.forEach((function(data,i){e.push(data)})),this.jsonData=e}}},l=c,d=n(93),f=n(114),h=n.n(f),v=n(897),m=n(240),_=n(751),x=n(760),w=n(218),y=n(752),C=n(901),S=n(900),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{staticClass:"chat-main-container"},[n("v-alert",{attrs:{border:"left","colored-border":"",color:"deep-purple accent-4",elevation:"10"}},[t._v(t._s(t.selected)+" ")]),t._v(" "),n("div",{attrs:{id:"app"}},[n("v-row",{attrs:{align:"center"}},[n("v-col",{staticClass:"d-flex",attrs:{cols:"8",sm:"6"}},[n("v-select",{attrs:{items:t.logUsers,outlined:"",label:"ユーザーを選択"},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1),t._v(" "),n("v-col",{staticClass:"d-flex",attrs:{cols:"4",sm:"6"}},[n("VueJsonToCsv",{attrs:{"json-data":t.csvData,"csv-title":t.csvTitle,labels:t.labels}},[n("v-btn",{attrs:{disabled:t.selectedBoolean,color:"green"},on:{click:t.download}},[n("v-icon",[t._v("mdi-download")])],1)],1)],1)],1)],1),t._v(" "),n("v-simple-table",{directives:[{name:"katex",rawName:"v-katex"}],staticStyle:{border:"1px solid gray"},attrs:{dense:"",elevation:"10","fixed-header":"",height:"500px"},scopedSlots:t._u([{key:"default",fn:function(){return[n("thead",[n("tr",[n("th",{staticClass:"text-left"},[t._v("date$x=a$")]),t._v(" "),n("th",{staticClass:"text-left"},[t._v("timestamp")]),t._v(" "),n("th",{staticClass:"text-left"},[t._v("id")]),t._v(" "),n("th",{staticClass:"text-left"},[t._v("action")]),t._v(" "),n("th",{staticClass:"text-left"},[t._v("tex")]),t._v(" "),n("th",{staticClass:"text-left"},[t._v("href")])])]),t._v(" "),n("tbody",t._l(t.history,(function(e){return n("tr",{key:e.timestamp},[n("td",[t._v(t._s(e.date))]),t._v(" "),n("td",[t._v(t._s(e.timestamp))]),t._v(" "),n("td",[t._v(t._s(e.id))]),t._v(" "),n("td",[t._v(t._s(e.action))]),t._v(" "),n("td",[t._v("$"+t._s(e.tex)+"$")]),t._v(" "),n("td",[t._v(t._s(e.href))])])})),0)]},proxy:!0}])}),t._v(" "),n("div",{staticStyle:{border:"2px solid green"}},[t._v("\n    "+t._s(t.sCSV)+"\n  ")])],1)}),[],!1,null,"6d79ff4d",null);e.default=component.exports;h()(component,{VAlert:v.a,VBtn:m.a,VCol:_.a,VContainer:x.a,VIcon:w.a,VRow:y.a,VSelect:C.a,VSimpleTable:S.a})}}]);